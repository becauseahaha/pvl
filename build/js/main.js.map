{"version":3,"file":"main.js","sources":["../../src/js/main.js"],"sourcesContent":["const typingText = () => {\n\n    async function typeSentence(sentence, el, delay = 100) {\n        const letters = sentence.split(\"\");\n        const $box = el;\n        let i = 0;\n        while (i < letters.length) {\n            await waitForMs(delay);\n            $box.innerHTML += letters[i];\n            i++;\n        }\n        return;\n    }\n    \n    async function deleteSentence(el) {\n        const $box = el;\n        const sentence = $box.innerHTML;\n        const letters = sentence.split(\"\");\n        while (letters.length > 0) {\n            await waitForMs(100);\n            letters.pop();\n            $box.innerText = letters.join(\"\");\n        }\n    }\n    \n    async function carousel(carouselList, el) {\n        var i = 1;\n        while (true) {\n            await waitForMs(2000);\n            await deleteSentence(el);\n            await waitForMs(500);\n            await typeSentence(carouselList[i].text, el);\n            await waitForMs(2000);\n            i++;\n            if (i >= carouselList.length) {\n                i = 0;\n            }\n        }\n    }\n\n    const elements = document.querySelectorAll('.js-typing-text');\n    elements.forEach((el) => {\n        let carouselList = [];\n        carouselList[0] = {'text': el.dataset.typingFirst}\n        carouselList[1] = {'text': el.dataset.typingSecond}\n        carousel(carouselList, el);\n        console.log(el.parentElement.offsetHeight)\n        el.parentElement.style.height = el.parentElement.offsetHeight + 'px'\n    })\n\n}\n\nconst accordion = () => {\n    // if (window.innerWidth > 767) return;\n    document.querySelectorAll('.js-accordion .btn').forEach((el) => {\n        el.addEventListener('click', function() {\n            // document.querySelectorAll('.js-contacts-card').forEach((el) => {\n            //     el.classList.remove('is-active');\n            // })\n            el.classList.toggle('btn-plus')\n            el.classList.toggle('btn-minus')\n            el.classList.toggle('btn-light-blue')\n            el.classList.toggle('btn-blue')\n            el.closest('.accordion__item').classList.toggle('is-active');\n        })\n    })\n}\n\nfunction waitForMs(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nfunction hidePopup(id) {\n    let popup = document.getElementById(id)\n        ? document.getElementById(id)\n        : this.closest(\".popup\");\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\")) {\n        popup.addEventListener(\n            \"transitionend\",\n            (e) => {\n                popup.style.display = \"none\";\n                popup.dataset.processing = false;\n            },\n            {\n                once: true,\n            }\n        );\n        popup.classList.remove(\"is-shown\");\n    }\n}\n\nfunction showPopup(id) {\n    let popup = document.getElementById(id);\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\") == false) {\n        popup.style.display = \"flex\";\n        setTimeout(function () {\n            popup.classList.add(\"is-shown\");\n            popup.dataset.processing = false;\n        }, 1);\n    }\n}\n\nconst headerButton = () => {\n    const $header = document.getElementById(\"header\");\n    const $backdrop = document.getElementById(\"header-backdrop\");\n    const $button = document.getElementById(\"header-button\");\n\n    $button.addEventListener(\"click\", () => {\n        if ($header.dataset.processing && $header.dataset.processing == true)\n            return;\n        $header.dataset.processing = true;\n        if ($header.classList.contains(\"is-fixed\") == false) {\n            $backdrop.style.display = \"block\";\n            setTimeout(function () {\n                $backdrop.classList.add(\"is-active\");\n                $header.dataset.processing = false;\n            }, 1);\n        } else {\n            $backdrop.addEventListener(\n                \"transitionend\",\n                (e) => {\n                    $backdrop.style.display = \"none\";\n                    $header.dataset.processing = false;\n                },\n                {\n                    once: true,\n                }\n            );\n            $backdrop.classList.remove(\"is-active\");\n        }\n        $header.classList.toggle(\"is-fixed\");\n    });\n};\n\nconst footer = () => {\n    const $footer = document.getElementById(\"footer\");\n    const height = $footer.scrollHeight;\n\n    document.body.style.paddingBottom = height + \"px\";\n};\n\nconst projectsBorder = () => {\n    const $projects = document.getElementById(\"projects\");\n    if (!$projects) return;\n\n    const i = $projects.querySelectorAll(\".project\").length;\n    let perLine = 4;\n\n    switch (true) {\n        case window.innerWidth < 767:\n            perLine = 1;\n            break;\n        case window.innerWidth < 1280:\n            perLine = 2;\n            break;\n    }\n\n    for (let k = 1; k <= Math.ceil(i / perLine); k++) {\n        const $line = document.createElement(\"div\");\n        $line.className = \"project__line\";\n        const startRow = k * 2;\n        const endtRow = startRow + 1;\n        $line.style.gridRow = startRow + \"/\" + endtRow;\n        $projects.appendChild($line);\n    }\n};\n\nconst yandexMap = () => {\n    const pin = {\n        iconLayout: \"default#image\",\n        iconImageHref: \"./../images/map-marker.png\",\n        iconImageSize: [80, 80],\n        iconImageOffset: [-19, -19],\n    };\n    let myMap = new ymaps.Map(\"yamap\", {\n        center: [59.929646, 30.400804],\n        zoom: 16,\n    });\n    let myPlacemark = new ymaps.Placemark(myMap.getCenter(), {}, pin);\n    myMap.geoObjects.add(myPlacemark);\n};\n\nconst mapScroll = () => {\n\n    const $map = document.getElementById(\"map-scroll\");\n    if ($map === null) return;\n\n    const $markers = $map.querySelectorAll('.map__marker');\n\n    let params, offset;\n\n    function onScroll() {\n\n        params = $map.getBoundingClientRect()\n        offset = (params.height - params.y-params.height) / params.height*100;\n\n        if (offset > 0) {\n            $markers[0].classList.add('is-active');\n        } else {\n            $markers[0].classList.remove('is-active');\n        }\n        if (offset > 15) {\n            $markers[1].classList.add('is-active');\n        } else {\n            $markers[1].classList.remove('is-active');\n        }\n        if (offset > 30) {\n            $markers[2].classList.add('is-active');\n        } else {\n            $markers[2].classList.remove('is-active');\n        }\n        if (offset > 45) {\n            $markers[3].classList.add('is-active');\n        } else {\n            $markers[3].classList.remove('is-active');\n        }\n    }\n\n    const observer = new IntersectionObserver(function (e) {\n        if (e[0].isIntersecting) {\n            window.addEventListener(\"scroll\", onScroll);\n        } else {\n            window.removeEventListener('scroll', onScroll)\n        }\n    });\n\n    observer.observe($map);\n};\n\n\nconst forms = () => {\n\n    const $contact = document.getElementById('contact-form');\n    const $contact_submit = $contact.querySelector('.js-submit');\n\n    $contact_submit.addEventListener('click', () => {\n\n        $contact.dataset.errors = 0;\n\n        const phone = $contact.querySelector('input[name=\"phone\"]');\n        const name = $contact.querySelector('input[name=\"name\"]');\n        const message = $contact.querySelector('[name=\"message\"]');\n\n        if (phone.value.length == 0) {\n            phone.classList.add('is-error');\n            $contact.dataset.errors++;\n        } else {\n            phone.classList.remove('is-error');\n        }\n        if (name.value.length == 0) {\n            name.classList.add('is-error');\n            $contact.dataset.errors++;\n        } else {\n            name.classList.remove('is-error');\n        }\n        if (message.value.length == 0) {\n            message.classList.add('is-error');\n            $contact.dataset.errors++;\n        } else {\n            message.classList.remove('is-error');\n        }\n\n        if ($contact.dataset.errors > 0) return;\n\n        const formData = new FormData($contact);\n        $contact.style.display = 'none';\n        document.getElementById('contact-form-success').style.display = 'block';\n        return;\n        fetch(\"/mailer.php\", {\n            method: \"POST\",\n            body: formData\n        })\n        .then(function(serverPromise) { \n            serverPromise.json()\n            .then(function(data) { \n                $contact.style.display = 'none';\n                document.getElementById('contact-form-success').style.display = 'flex';\n            });\n        });\n\n    })\n\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    headerButton();\n    projectsBorder();\n    mapScroll();\n    typingText();\n    accordion();\n    forms();\n\n    if (typeof ymaps !== \"undefined\") ymaps.ready(yandexMap);\n\n    document.querySelectorAll(\".js-popup-hide\").forEach((el) => {\n        el.addEventListener(\"click\", hidePopup.bind(el));\n    });\n\n    document.querySelectorAll(\".popup\").forEach((el) => {\n        el.addEventListener(\"click\", function (e) {\n            if (e.target == el) {\n                hidePopup(e.target.id);\n            }\n        });\n    });\n\n    document.querySelectorAll(\".js-popup-show\").forEach((el) => {\n        el.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n            showPopup(el.dataset.target, el.dataset);\n        });\n    });\n});\n"],"names":["typingText","typeSentence","sentence","el","delay","letters","split","$box","i","length","waitForMs","innerHTML","deleteSentence","pop","innerText","join","document","querySelectorAll","forEach","carouselList","text","dataset","typingFirst","typingSecond","log","parentElement","offsetHeight","style","height","ms","Promise","resolve","setTimeout","hidePopup","id","popup","getElementById","this","closest","processing","classList","contains","addEventListener","e","display","remove","yandexMap","myMap","ymaps","Map","myPlacemark","Placemark","getCenter","geoObjects","add","$header","$backdrop","toggle","$projects","perLine","window","innerWidth","k","Math","ceil","$line","createElement","className","startRow","endtRow","gridRow","appendChild","$map","$markers","params","offset","onScroll","getBoundingClientRect","y","IntersectionObserver","isIntersecting","removeEventListener","observe","$contact","querySelector","errors","phone","name","message","value","FormData","ready","bind","target","preventDefault"],"mappings":"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"}